{% load static %}
{% block styles %}
    <link rel="stylesheet" href="{% static 'css/report.css' %}">
{% endblock styles %}

{% if match_results %}
<div id="match-report">
        <!-- Puntuaci√≥n General -->
        <div id="overall-score">
            <div class="overall-score__circle-progress" style="--value: {{ match_results.overall_score }};">
                <div class="circle-progress__inner">
                    <p class="overall-score__value">{{ match_results.overall_score }}%</p>
                </div>
            </div>
            {% if match_results.overall_score >= 70 %}
                <p class="overall-score__message">¬°Excelente compatibilidad!</p>
            {% elif match_results.overall_score >= 50 %}
                <p class="overall-score__message">Buena compatibilidad, pero hay √°reas de mejora.</p>
            {% else %}
                <p class="overall-score__message">Hay oportunidades para mejorar tu perfil.</p>
            {% endif %}
        </div>
    
    <!-- Tecnolog√≠as -->
    <div id="technologies" class="report-section">
        {% if match_results.technology_match.matched_technologies %}
            <div class="technologies__matched report-card matched">
                <p class="technologies__matched-title report-title">
                    <span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#1c8f1f">
                        <path d="M12.01 2.011a3.2 3.2 0 0 1 2.113 .797l.154 .145l.698 .698a1.2 1.2 0 0 0 .71 .341l.135 .008h1a3.2 3.2 0 0 1 3.195 3.018l.005 .182v1c0 .27 .092 .533 .258 .743l.09 .1l.697 .698a3.2 3.2 0 0 1 .147 4.382l-.145 .154l-.698 .698a1.2 1.2 0 0 0 -.341 .71l-.008 .135v1a3.2 3.2 0 0 1 -3.018 3.195l-.182 .005h-1a1.2 1.2 0 0 0 -.743 .258l-.1 .09l-.698 .697a3.2 3.2 0 0 1 -4.382 .147l-.154 -.145l-.698 -.698a1.2 1.2 0 0 0 -.71 -.341l-.135 -.008h-1a3.2 3.2 0 0 1 -3.195 -3.018l-.005 -.182v-1a1.2 1.2 0 0 0 -.258 -.743l-.09 -.1l-.697 -.698a3.2 3.2 0 0 1 -.147 -4.382l.145 -.154l.698 -.698a1.2 1.2 0 0 0 .341 -.71l.008 -.135v-1l.005 -.182a3.2 3.2 0 0 1 3.013 -3.013l.182 -.005h1a1.2 1.2 0 0 0 .743 -.258l.1 -.09l.698 -.697a3.2 3.2 0 0 1 2.269 -.944zm3.697 7.282a1 1 0 0 0 -1.414 0l-3.293 3.292l-1.293 -1.292l-.094 -.083a1 1 0 0 0 -1.32 1.497l2 2l.094 .083a1 1 0 0 0 1.32 -.083l4 -4l.083 -.094a1 1 0 0 0 -.083 -1.32z" />
                        </svg>
                    </span>
                    Tecnolog√≠as que coinciden
                </p>
                <ul class="technologies__list">
                    {% for tech in match_results.technology_match.matched_technologies %}
                        <li>{{ tech }}</li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}
        {% if match_results.technology_match.missing_technologies %}
            <div class="technologies__missing report-card mismatched">
                <p class="technologies__missing-title report-title">
                    <span>
                        <svg
                        xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#cb2727">
                        <path d="M14 3.072a8 8 0 0 1 2.32 11.834l5.387 5.387a1 1 0 0 1 -1.414 1.414l-5.388 -5.387a8 8 0 0 1 -12.905 -6.32l.005 -.285a8 8 0 0 1 11.995 -6.643m-4 8.928a1 1 0 0 0 -1 1l.007 .127a1 1 0 0 0 1.993 -.117l-.007 -.127a1 1 0 0 0 -.993 -.883m0 -6a1 1 0 0 0 -1 1v3a1 1 0 0 0 2 0v-3a1 1 0 0 0 -1 -1" />
                        </svg>
                    </span>
                    Tecnolog√≠as que faltan
                </p>
               <ul class="technologies__list">
                    {% for tech in match_results.technology_match.missing_technologies %}
                        <li>{{ tech }}</li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}
    </div>

    <!-- Palabras Clave -->
    <div>
        <h3>Palabras Clave y Habilidades ({{ match_results.keyword_match.match_score|floatformat:1 }}%)</h3>
        
        <!-- Verbos de Acci√≥n -->
        {% if match_results.keyword_match.matched_keywords.action_verbs.items %}
            <p>‚úÖ {{ match_results.keyword_match.matched_keywords.action_verbs.description }}:</p>
            <ul>
                {% for verb in match_results.keyword_match.matched_keywords.action_verbs.items %}
                    <li>{{ verb }}</li>
                {% endfor %}
            </ul>
        {% endif %}
        
        <!-- Habilidades Blandas -->
        {% if match_results.keyword_match.matched_keywords.soft_skills.items %}
            <p>‚úÖ {{ match_results.keyword_match.matched_keywords.soft_skills.description }}:</p>
            <ul>
                {% for skill in match_results.keyword_match.matched_keywords.soft_skills.items %}
                    <li>{{ skill }}</li>
                {% endfor %}
            </ul>
        {% endif %}
        
        <!-- Frases Relevantes -->
        {% if match_results.keyword_match.matched_keywords.phrases.items %}
            <p>‚úÖ {{ match_results.keyword_match.matched_keywords.phrases.description }}:</p>
            <ul>
                {% for phrase in match_results.keyword_match.matched_keywords.phrases.items %}
                    <li>{{ phrase }}</li>
                {% endfor %}
            </ul>
        {% endif %}
    </div>

    <!-- Experiencia Relevante -->
    <div class="career-experience">
        <h3>Experiencia Laboral M√°s Relevante</h3>
        {% if match_results.career_items.details %}
            <div>
                {% for item in match_results.career_items.details|slice:":3" %}
                    <div>
                        <h4>{{ item.title }} - {{ item.institution }}</h4>
                        <p><strong>Relevancia:</strong> {{ item.relevance_score|floatformat:2 }} ({{ item.relevance_score|floatformat:0 }}%)</p>
                        <p><strong>Periodo:</strong> 
                            {{ item.start_date|date:"M Y" }}
                            {% if item.end_date %}
                                - {{ item.end_date|date:"M Y" }}
                            {% else %}
                                - Actualidad
                            {% endif %}
                        </p>
                        {% if item.description %}
                            <p><strong>Descripci√≥n:</strong> {{ item.description|truncatewords:25 }}</p>
                        {% endif %}
                        <hr>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No se encontraron experiencias laborales relevantes. Considera agregar m√°s experiencias laborales a tu perfil.</p>
        {% endif %}
    </div>

    <!-- Sugerencias de Mejora -->
    <div>
        <h3>Sugerencias de Mejora</h3>        
        {% if match_results.keyword_match.missing_keywords.action_verbs.items %}
            <p>üìù {{ match_results.keyword_match.missing_keywords.action_verbs.description }}:</p>
            <ul>
                {% for verb in match_results.keyword_match.missing_keywords.action_verbs.items|slice:":5" %}
                    <li>{{ verb }}</li>
                {% endfor %}
            </ul>
        {% endif %}
        
        {% if match_results.keyword_match.missing_keywords.soft_skills.items %}
            <p>ü§ù {{ match_results.keyword_match.missing_keywords.soft_skills.description }}:</p>
            <ul>
                {% for skill in match_results.keyword_match.missing_keywords.soft_skills.items|slice:":5" %}
                    <li>{{ skill }}</li>
                {% endfor %}
            </ul>
        {% endif %}
        
        {% if match_results.keyword_match.missing_keywords.phrases.items %}
            <p>üîß {{ match_results.keyword_match.missing_keywords.phrases.description }}:</p>
            <ul>
                {% for phrase in match_results.keyword_match.missing_keywords.phrases.items|slice:":5" %}
                    <li>{{ phrase }}</li>
                {% endfor %}
            </ul>
        {% endif %}
    </div>
</div>
{% endif %}