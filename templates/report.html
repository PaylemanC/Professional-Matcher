{% load static %}

{% if match_results %}
    <div id="match-report">
        <!-- Puntuaci√≥n General -->
        <div class="overall-score">
            <h3>Puntuaci√≥n General: {{ match_results.overall_score }}%</h3>
            {% if match_results.overall_score >= 70 %}
                <p class="score-message success">¬°Excelente compatibilidad!</p>
            {% elif match_results.overall_score >= 50 %}
                <p class="score-message warning">Buena compatibilidad, pero hay √°reas de mejora.</p>
            {% else %}
                <p class="score-message info">Hay oportunidades para mejorar tu perfil.</p>
            {% endif %}
        </div>
    </div>
    <!-- Tecnolog√≠as -->
    <div class="technologies">
        <h3>Tecnolog√≠as ({{ match_results.technology_match.match_score|floatformat:1 }}%)</h3>
        {% if match_results.technology_match.matched_technologies %}
            <p>‚úÖ Tecnolog√≠as que dominas:</p>
            <ul>
                {% for tech in match_results.technology_match.matched_technologies %}
                    <li>{{ tech }}</li>
                {% endfor %}
            </ul>
        {% endif %}
        
        {% if match_results.technology_match.missing_technologies %}
            <p>‚ùå Tecnolog√≠as que te faltan:</p>
            <ul>
                {% for tech in match_results.technology_match.missing_technologies %}
                    <li>{{ tech }}</li>
                {% endfor %}
            </ul>
        {% endif %}
    </div>

    <!-- Palabras Clave -->
    <div>
        <h3>Palabras Clave y Habilidades ({{ match_results.keyword_match.match_score|floatformat:1 }}%)</h3>
        
        <!-- Verbos de Acci√≥n -->
        {% if match_results.keyword_match.matched_keywords.action_verbs.items %}
            <p>‚úÖ {{ match_results.keyword_match.matched_keywords.action_verbs.description }}:</p>
            <ul>
                {% for verb in match_results.keyword_match.matched_keywords.action_verbs.items %}
                    <li>{{ verb }}</li>
                {% endfor %}
            </ul>
        {% endif %}
        
        <!-- Habilidades Blandas -->
        {% if match_results.keyword_match.matched_keywords.soft_skills.items %}
            <p>‚úÖ {{ match_results.keyword_match.matched_keywords.soft_skills.description }}:</p>
            <ul>
                {% for skill in match_results.keyword_match.matched_keywords.soft_skills.items %}
                    <li>{{ skill }}</li>
                {% endfor %}
            </ul>
        {% endif %}
        
        <!-- Frases Relevantes -->
        {% if match_results.keyword_match.matched_keywords.phrases.items %}
            <p>‚úÖ {{ match_results.keyword_match.matched_keywords.phrases.description }}:</p>
            <ul>
                {% for phrase in match_results.keyword_match.matched_keywords.phrases.items %}
                    <li>{{ phrase }}</li>
                {% endfor %}
            </ul>
        {% endif %}
    </div>

    <!-- Experiencia Relevante -->
    <div class="career-experience">
        <h3>Experiencia Laboral M√°s Relevante</h3>
        {% if match_results.career_items.details %}
            <div>
                {% for item in match_results.career_items.details|slice:":3" %}
                    <div>
                        <h4>{{ item.title }} - {{ item.institution }}</h4>
                        <p><strong>Relevancia:</strong> {{ item.relevance_score|floatformat:2 }} ({{ item.relevance_score|floatformat:0 }}%)</p>
                        <p><strong>Periodo:</strong> 
                            {{ item.start_date|date:"M Y" }}
                            {% if item.end_date %}
                                - {{ item.end_date|date:"M Y" }}
                            {% else %}
                                - Actualidad
                            {% endif %}
                        </p>
                        {% if item.description %}
                            <p><strong>Descripci√≥n:</strong> {{ item.description|truncatewords:25 }}</p>
                        {% endif %}
                        <hr>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No se encontraron experiencias laborales relevantes. Considera agregar m√°s experiencias laborales a tu perfil.</p>
        {% endif %}
    </div>

    <!-- Sugerencias de Mejora -->
    <div>
        <h3>Sugerencias de Mejora</h3>        
        {% if match_results.keyword_match.missing_keywords.action_verbs.items %}
            <p>üìù {{ match_results.keyword_match.missing_keywords.action_verbs.description }}:</p>
            <ul>
                {% for verb in match_results.keyword_match.missing_keywords.action_verbs.items|slice:":5" %}
                    <li>{{ verb }}</li>
                {% endfor %}
            </ul>
        {% endif %}
        
        {% if match_results.keyword_match.missing_keywords.soft_skills.items %}
            <p>ü§ù {{ match_results.keyword_match.missing_keywords.soft_skills.description }}:</p>
            <ul>
                {% for skill in match_results.keyword_match.missing_keywords.soft_skills.items|slice:":5" %}
                    <li>{{ skill }}</li>
                {% endfor %}
            </ul>
        {% endif %}
        
        {% if match_results.keyword_match.missing_keywords.phrases.items %}
            <p>üîß {{ match_results.keyword_match.missing_keywords.phrases.description }}:</p>
            <ul>
                {% for phrase in match_results.keyword_match.missing_keywords.phrases.items|slice:":5" %}
                    <li>{{ phrase }}</li>
                {% endfor %}
            </ul>
        {% endif %}
    </div>

{% endif %}

    <!-- Oferta Laboral Analizada -->
    <div>
        <h3>Oferta Laboral Analizada</h3>
        <p>{{ match_results.job_offer|truncatewords:50 }}</p>
    </div>
</div>